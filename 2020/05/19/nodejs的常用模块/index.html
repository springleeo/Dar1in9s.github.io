<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="node.js及其常用模块"><meta name="keywords" content="node.js"><meta name="author" content="Dar1in9"><meta name="copyright" content="Dar1in9"><title>node.js及其常用模块 | Dar1in9's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="dns-prefetch" href="http://ta.qq.com"><script>(function() {
   var hm = document.createElement("script");
   hm.src = "https://tajs.qq.com/stats?sId=&lt;script type=&quot;text/javascript&quot; src=&quot;http://tajs.qq.com/stats?sId=66549793&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;";
   var s = document.getElementsByTagName("script")[0];
   s.parentNode.insertBefore(hm, s);
 })();</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"MY1GAADR9W","apiKey":"5032629da4e94f659d98a4052bc1c5cd","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#模块"><span class="toc-number">1.</span> <span class="toc-text">模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#exports-向外暴露多个对象"><span class="toc-number">1.1.</span> <span class="toc-text">exports 向外暴露多个对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#module-exports-向外暴露单个对象"><span class="toc-number">1.2.</span> <span class="toc-text">module.exports 向外暴露单个对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#node-modules文件夹"><span class="toc-number">1.3.</span> <span class="toc-text">node_modules文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#阶段1-粗查阶段"><span class="toc-number">1.3.1.</span> <span class="toc-text">阶段1. 粗查阶段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#阶段2-精确查找，获取文件绝对路径"><span class="toc-number">1.3.2.</span> <span class="toc-text">阶段2. 精确查找，获取文件绝对路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用-package-json-管理依赖"><span class="toc-number">1.4.</span> <span class="toc-text">使用 package.json 管理依赖</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Http模块"><span class="toc-number">2.</span> <span class="toc-text">Http模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#GET-POST请求"><span class="toc-number">2.1.</span> <span class="toc-text">GET&#x2F;POST请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取GET请求内容"><span class="toc-number">2.1.1.</span> <span class="toc-text">获取GET请求内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取POST请求内容"><span class="toc-number">2.1.2.</span> <span class="toc-text">获取POST请求内容</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url模块"><span class="toc-number">3.</span> <span class="toc-text">url模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#url-parse"><span class="toc-number">3.1.</span> <span class="toc-text">url.parse()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#url-format"><span class="toc-number">3.2.</span> <span class="toc-text">url.format()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#path模块"><span class="toc-number">4.</span> <span class="toc-text">path模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#path-parse"><span class="toc-number">4.1.</span> <span class="toc-text">path.parse()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-dirname"><span class="toc-number">4.2.</span> <span class="toc-text">path.dirname()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-basename-p-ext"><span class="toc-number">4.3.</span> <span class="toc-text">path.basename(p[, ext])</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-dirname-p"><span class="toc-number">4.4.</span> <span class="toc-text">path.dirname(p)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#path-extname-p"><span class="toc-number">4.5.</span> <span class="toc-text">path.extname(p)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fs模块"><span class="toc-number">5.</span> <span class="toc-text">fs模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#标识位-flag"><span class="toc-number">5.1.</span> <span class="toc-text">标识位 flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件读取"><span class="toc-number">5.2.</span> <span class="toc-text">文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#同步读取方法（readFileSync）"><span class="toc-number">5.2.1.</span> <span class="toc-text">同步读取方法（readFileSync）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异步读取文件（readFile）"><span class="toc-number">5.2.2.</span> <span class="toc-text">异步读取文件（readFile）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件写入"><span class="toc-number">5.3.</span> <span class="toc-text">文件写入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#同步写入（writeFileSync）"><span class="toc-number">5.3.1.</span> <span class="toc-text">同步写入（writeFileSync）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异步写入（writeFile）"><span class="toc-number">5.3.2.</span> <span class="toc-text">异步写入（writeFile）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#鸣谢"><span class="toc-number">6.</span> <span class="toc-text">鸣谢</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://blog-1300147235.cos.ap-chengdu.myqcloud.com/kakashi-cat.jpg"></div><div class="author-info__name text-center">Dar1in9</div><div class="author-info__description text-center">人间值得，未来可期</div><div class="follow-button"><a href="https://github.com/Dar1in9s" target="_blank" rel="noopener">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">58</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">21</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://blog-1300147235.cos.ap-chengdu.myqcloud.com/Background2.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Dar1in9's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">node.js及其常用模块</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-05-19</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2.8k</span><span class="post-meta__separator">|</span><span>阅读时长: 10 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>Node.js是运行在服务端的JavaScript，基于Google的V8引擎，V8引擎执行Javascript的速度非常快，性能非常好。<br>其特点：单线程，异步非阻塞I/O，事件驱动，速度快</p>
<a id="more"></a>
<h1 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h1><p>引用模块使用<code>require</code>函数</p>
<p>模块加载机制被称为<code>CommonJS</code>规范。在这个规范下，每个<code>.js</code>文件都是一个模块，它们内部各自使用的变量名和函数名都互不冲突，例如，<code>hello.js</code>和<code>main.js</code>都申明了全局变量<code>var s = &#39;xxx&#39;</code>，但互不影响。</p>
<h2 id="exports-向外暴露多个对象"><a href="#exports-向外暴露多个对象" class="headerlink" title="exports 向外暴露多个对象"></a>exports 向外暴露多个对象</h2><ul>
<li>对外暴露对象<br>使用<code>exports.[function name] = [function name]</code></li>
<li>引用暴露的对象<br><code>xxx = require(&#39;./a&#39;)</code><br>此时的<code>xxx</code>等价于a文件中的<code>exports</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// func.js</span></span><br><span class="line">exports.add = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> num1 + num2;</span><br><span class="line">exports.sub = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> num1 - num2;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">var</span> func = <span class="built_in">require</span>(<span class="string">'./func'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(func.add(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">console</span>.log(func.sub(<span class="number">1</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<h2 id="module-exports-向外暴露单个对象"><a href="#module-exports-向外暴露单个对象" class="headerlink" title="module.exports 向外暴露单个对象"></a>module.exports 向外暴露单个对象</h2><ul>
<li>一个模块想要对外暴露变量（函数也是变量），可以用<code>module.exports = variable;</code>，输出的变量可以是任意对象、函数、数组等等。</li>
<li>一个模块要引用其他模块暴露的变量，用<code>var ref = require(&#39;module_name&#39;);</code>就拿到了引用模块的变量。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// func.js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(s + <span class="string">', '</span> + name + <span class="string">'!'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = func;   <span class="comment">// 使用module.exports来对外暴露变量</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mian.js</span></span><br><span class="line"><span class="keyword">var</span> func = <span class="built_in">require</span>(<span class="string">'./func'</span>);</span><br><span class="line"></span><br><span class="line">func()    <span class="comment">// 直接调用</span></span><br></pre></td></tr></table></figure>

<p><code>exports</code>是<code>module.exports</code>的一个引用，<code>exports</code>指向的是<code>module.exports</code></p>
<h2 id="node-modules文件夹"><a href="#node-modules文件夹" class="headerlink" title="node_modules文件夹"></a>node_modules文件夹</h2><p><code>node_modules</code>是安装node后用来存放用包管理工具下载安装的包的文件夹.</p>
<p>node是如何找到模块的?</p>
<h3 id="阶段1-粗查阶段"><a href="#阶段1-粗查阶段" class="headerlink" title="阶段1. 粗查阶段"></a>阶段1. 粗查阶段</h3><ul>
<li>如果是node核心模块，就直接返回模块名称</li>
<li>如果是引入的第三方npm模块，会返回父级所在文件夹下的<code>node_modules</code>，父父级所在文件夹下的<code>node_modules</code>，依次递归，一直到<code>/node_modules</code>和用户名下的<code>.node_modules</code>以及全局环境变量配置的全局安装的模块文件夹组成的数组</li>
<li>如果是相对路径引入的模块，会将相对路径和父级路径之间进行一个<code>path.resolve()</code>，然后返回</li>
</ul>
<h3 id="阶段2-精确查找，获取文件绝对路径"><a href="#阶段2-精确查找，获取文件绝对路径" class="headerlink" title="阶段2. 精确查找，获取文件绝对路径"></a>阶段2. 精确查找，获取文件绝对路径</h3><p>以<code>require(&#39;express&#39;)</code>为例</p>
<ul>
<li>先尝试加载<code>node_modules/express</code>，这种没有扩展名的文件是否存在</li>
<li>尝试按照扩展名规则查找，依次判断<code>node_modules</code>文件夹下<code>.js .json .node</code>结尾的文件名为<code>express</code>的文件是否存在，返回文件的绝对路径</li>
<li>判断<code>node_modules/express</code>文件夹下的<code>package.json</code>是否存在，如果存在，返回main字段指定的文件的绝对路径</li>
<li>判断<code>node_modules/express/index.js</code>是否存在，存在返回对应文件绝对路径</li>
</ul>
<h2 id="使用-package-json-管理依赖"><a href="#使用-package-json-管理依赖" class="headerlink" title="使用 package.json 管理依赖"></a>使用 package.json 管理依赖</h2><p>一个 package.json 文件可以有以下几点作用：</p>
<ul>
<li>作为一个描述文件，<strong>描述了你的项目依赖哪些包</strong></li>
<li>允许我们使用 “语义化版本规则” 指明你项目依赖包的版本</li>
<li>让你的构建更好地与其他开发者分享，便于重复使用</li>
</ul>
<h1 id="Http模块"><a href="#Http模块" class="headerlink" title="Http模块"></a>Http模块</h1><p>nodejs不需要使用apache、nginx等服务器，nodejs不仅仅实现了一个应用，同时还实现了整个http服务器。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = http.createServer(<span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">    response.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain; charset=utf-8"</span>&#125;);   <span class="comment">// 设置响应头</span></span><br><span class="line">    response.end(<span class="string">"hello world"</span>);         <span class="comment">// 设置响应内容</span></span><br><span class="line">&#125;);</span><br><span class="line">app.listen(<span class="number">80</span>);    <span class="comment">// 开启服务</span></span><br></pre></td></tr></table></figure>

<p>http模块的<code>createServer</code>的回调函数中</p>
<ul>
<li><code>request</code>代表客户端的请求数据，是一个可读流<br><code>request.url</code> 请求的 url 路由<br><code>request.method</code> 请求的方式（GET、POST…）<br></li>
<li><code>response</code>代表服务端的响应数据，是一个可写流<br><code>response.write(xxx)</code> 往响应中写数据<br><code>response.end(xxx)</code>  结束写返回数据<br><code>response.setHeader(xxx)</code> 设置响应头<br>响应中的内容只能是二进制流或字符串</li>
</ul>
<h2 id="GET-POST请求"><a href="#GET-POST请求" class="headerlink" title="GET/POST请求"></a>GET/POST请求</h2><p>请求方式可以通过<code>request.method</code>获取</p>
<h3 id="获取GET请求内容"><a href="#获取GET请求内容" class="headerlink" title="获取GET请求内容"></a>获取GET请求内容</h3><p>由于GET请求直接被嵌入在路径中，URL是完整的请求路径，包括了<code>?</code>后面的部分，因此可以手动解析后面的内容作为GET请求的参数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> request_get = url.parse(request.url, <span class="literal">true</span>)[<span class="string">'query'</span>];</span><br></pre></td></tr></table></figure>

<h3 id="获取POST请求内容"><a href="#获取POST请求内容" class="headerlink" title="获取POST请求内容"></a>获取POST请求内容</h3><p>POST请求的内容全部的都在请求体中，<code>http.ServerRequest</code>并没有一个属性内容为请求体，原因是等待请求体传输可能是一件耗时的工作。</p>
<p>比如上传文件，而很多时候我们可能并不需要理会请求体的内容，恶意的POST请求会大大消耗服务器的资源，所有<code>node.js</code>默认是不会解析请求体的， 当你需要的时候，需要手动来做。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);</span><br><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> post = <span class="string">''</span>;     <span class="comment">//定义了一个post变量，用于暂存请求体的信息</span></span><br><span class="line"> </span><br><span class="line">    request.on(<span class="string">'data'</span>, (chunk) =&gt; &#123; post += chunk;&#125;);   <span class="comment">//通过req的data事件监听函数，每当接受到请求体的数据，就累加到post变量中</span></span><br><span class="line"> </span><br><span class="line">    request.on(<span class="string">'end'</span>, () =&gt; &#123;    <span class="comment">//在end事件触发后，通过querystring.parse将post解析为真正的POST请求格式，然后向客户端返回。</span></span><br><span class="line">        post = querystring.parse(post);</span><br><span class="line">        <span class="keyword">for</span> (key <span class="keyword">in</span> post) &#123;</span><br><span class="line">            response.write(key + <span class="string">'='</span> + post[key] + <span class="string">'&lt;br&gt;'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        response.end(<span class="string">""</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;).listen(<span class="number">80</span>);</span><br></pre></td></tr></table></figure>

<h1 id="url模块"><a href="#url模块" class="headerlink" title="url模块"></a>url模块</h1><h2 id="url-parse"><a href="#url-parse" class="headerlink" title="url.parse()"></a><code>url.parse()</code></h2><p>解析一个url地址，返回一个url对象<br><code>url.parse(url, bool parseQueryString = false, bool slashesDenoteHost = false)</code></p>
<ul>
<li><code>url</code>: url地址字符串</li>
<li><code>parseQueryString</code>: 若为true，返回的url对象中<code>query</code>属性返回的是一个对象</li>
<li><code>slashesDenoteHost</code>: 若为true，则<code>//</code>之后至下一个<code>/</code>之前的字符串会解析作为<code>host</code>.<br>例如,<code>//foo/bar</code>会解析为<code>{host:&#39;foo&#39;,pathname:&#39;/bar&#39;}</code> 而不是 <code>{pathname:&#39;//foo/bar&#39;}</code>.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(url.parse(<span class="string">'http://127.0.0.1:5000/test/test?id=1&amp;name=a#123'</span>))</span><br><span class="line"></span><br><span class="line">结果为：</span><br><span class="line">Url &#123;</span><br><span class="line">  protocol: <span class="string">'http:'</span>,</span><br><span class="line">  slashes: <span class="literal">true</span>,</span><br><span class="line">  auth: <span class="literal">null</span>,</span><br><span class="line">  host: <span class="string">'127.0.0.1:5000'</span>,</span><br><span class="line">  port: <span class="string">'5000'</span>,</span><br><span class="line">  hostname: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">  hash: <span class="string">'#123'</span>,</span><br><span class="line">  search: <span class="string">'?id=1&amp;name=a'</span>,</span><br><span class="line">  query: <span class="string">'id=1&amp;name=a'</span>,</span><br><span class="line">  pathname: <span class="string">'/test/test'</span>,</span><br><span class="line">  path: <span class="string">'/test/test?id=1&amp;name=a'</span>,</span><br><span class="line">  href: <span class="string">'http://127.0.0.1:5000/test/test?id=1&amp;name=a#123'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>若第二个参数为<code>true</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(url.parse(<span class="string">'http://127.0.0.1:5000/test/test?id=1&amp;name=a#123'</span>, <span class="literal">true</span>))</span><br><span class="line"></span><br><span class="line">Url &#123;</span><br><span class="line">  protocol: <span class="string">'http:'</span>,</span><br><span class="line">  slashes: <span class="literal">true</span>,</span><br><span class="line">  auth: <span class="literal">null</span>,</span><br><span class="line">  host: <span class="string">'127.0.0.1:5000'</span>,</span><br><span class="line">  port: <span class="string">'5000'</span>,</span><br><span class="line">  hostname: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">  hash: <span class="string">'#123'</span>,</span><br><span class="line">  search: <span class="string">'?id=1&amp;name=a'</span>,</span><br><span class="line">  query: [<span class="built_in">Object</span>: <span class="literal">null</span> prototype] &#123; <span class="attr">id</span>: <span class="string">'1'</span>, <span class="attr">name</span>: <span class="string">'a'</span> &#125;,</span><br><span class="line">  pathname: <span class="string">'/test/test'</span>,</span><br><span class="line">  path: <span class="string">'/test/test?id=1&amp;name=a'</span>,</span><br><span class="line">  href: <span class="string">'http://127.0.0.1:5000/test/test?id=1&amp;name=a#123'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="url-format"><a href="#url-format" class="headerlink" title="url.format()"></a><code>url.format()</code></h2><p>将一个url对象转化成url字符串</p>
<p><code>url.format(urlObject)</code><br>其中的<code>urlObject</code>是一个url对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> urlobj = &#123;</span><br><span class="line">    protocol: <span class="string">'http'</span>,</span><br><span class="line">    hostname: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port: <span class="string">'5000'</span>,</span><br><span class="line">    pathname: <span class="string">'/login'</span>,</span><br><span class="line">    query: &#123;</span><br><span class="line">        id: <span class="number">1</span>,</span><br><span class="line">        user: <span class="string">'admin'</span>,</span><br><span class="line">        pass: <span class="string">'pass'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(url.format(urlobj))</span><br><span class="line"></span><br><span class="line">结果： http:<span class="comment">//127.0.0.1:5000/login?id=1&amp;user=admin&amp;pass=pass</span></span><br></pre></td></tr></table></figure>


<h1 id="path模块"><a href="#path模块" class="headerlink" title="path模块"></a>path模块</h1><p>path 模块提供了一些用于处理文件路径的小工具</p>
<h2 id="path-parse"><a href="#path-parse" class="headerlink" title="path.parse()"></a>path.parse()</h2><p>解析并返回路径字符串的对象。</p>
<p><code>path.parse(pathString)</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let file_path &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.html&#39;</span><br><span class="line">console.log(path.parse(file_path))</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">&#123;</span><br><span class="line">  root: &#39;&#x2F;&#39;,</span><br><span class="line">  dir: &#39;&#x2F;var&#x2F;www&#x2F;html&#39;,</span><br><span class="line">  base: &#39;index.html&#39;,  </span><br><span class="line">  ext: &#39;.html&#39;,        </span><br><span class="line">  name: &#39;index&#39;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="path-dirname"><a href="#path-dirname" class="headerlink" title="path.dirname()"></a>path.dirname()</h2><p>返回路径中代表文件夹的部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path.dirname(<span class="string">'/var/www/html/index.html'</span>);</span><br><span class="line"></span><br><span class="line">==&gt;  <span class="regexp">/var/</span>www/html</span><br></pre></td></tr></table></figure>
<h2 id="path-basename-p-ext"><a href="#path-basename-p-ext" class="headerlink" title="path.basename(p[, ext])"></a>path.basename(p[, ext])</h2><p>返回路径中的最后一部分(文件名)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path.basename(<span class="string">'/var/www/html/index.html'</span>);</span><br><span class="line"></span><br><span class="line">==&gt;  index.html</span><br></pre></td></tr></table></figure>
<h2 id="path-dirname-p"><a href="#path-dirname-p" class="headerlink" title="path.dirname(p)"></a>path.dirname(p)</h2><p>返回路径中代表文件夹的部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path.basename(<span class="string">'/var/www/html/index.html'</span>);</span><br><span class="line"></span><br><span class="line">==&gt;  <span class="regexp">/var/</span>www/html</span><br></pre></td></tr></table></figure>
<h2 id="path-extname-p"><a href="#path-extname-p" class="headerlink" title="path.extname(p)"></a>path.extname(p)</h2><p>返回路径中文件的后缀名，即路径中最后一个<code>.</code>之后的部分。<br>如果一个路径中并不包含<code>.</code>或该路径只包含一个<code>.</code> 且这个<code>.</code>为路径的第一个字符，则此命令返回空字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">path.extname(<span class="string">'/var/www/html/index.html'</span>);</span><br><span class="line"></span><br><span class="line">==&gt;  .html</span><br></pre></td></tr></table></figure>

<h1 id="fs模块"><a href="#fs模块" class="headerlink" title="fs模块"></a>fs模块</h1><p><code>Node.js</code>内置的<code>fs</code>模块就是文件系统模块，负责读写文件。(file system)</p>
<p>所有与文件操作都是通过<code>fs</code>核心模块来实现的，包括文件目录的创建、删除、查询以及文件的读取和写入，在 <code>fs</code> 模块中，所有的方法都分为同步和异步两种实现，具有 <code>sync</code> 后缀的方法为同步方法，不具有 <code>sync</code> 后缀的方法为异步方法，在了解文件操作的方法之前有一些关于系统和文件的前置知识，如文件的权限位 <code>mode</code>、标识位 <code>flag</code>、文件描述符 <code>fd</code> 等</p>
<h2 id="标识位-flag"><a href="#标识位-flag" class="headerlink" title="标识位 flag"></a>标识位 flag</h2><p>NodeJS 中，标识位代表着对文件的操作方式，如可读、可写、即可读又可写等等</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>r</code></td>
<td>读取文件，如果文件不存在则抛出异常。</td>
</tr>
<tr>
<td><code>r+</code></td>
<td>读取并写入文件，如果文件不存在则抛出异常。</td>
</tr>
<tr>
<td><code>rs</code></td>
<td>读取并写入文件，指示操作系统绕开本地文件系统缓存。</td>
</tr>
<tr>
<td><code>w</code></td>
<td>写入文件，文件不存在会被创建，存在则清空后写入。</td>
</tr>
<tr>
<td><code>wx</code></td>
<td>写入文件，排它方式打开。</td>
</tr>
<tr>
<td><code>w+</code></td>
<td>读取并写入文件，文件不存在则创建文件，存在则清空后写入。</td>
</tr>
<tr>
<td><code>wx+</code></td>
<td>和 <code>w+</code> 类似，排他方式打开。</td>
</tr>
<tr>
<td><code>a</code></td>
<td>追加写入，文件不存在则创建文件。</td>
</tr>
<tr>
<td><code>ax</code></td>
<td>与 <code>a</code> 类似，排他方式打开。</td>
</tr>
<tr>
<td><code>a+</code></td>
<td>读取并追加写入，不存在则创建。</td>
</tr>
<tr>
<td><code>ax+</code></td>
<td>与 <code>a+</code> 类似，排他方式打开。</td>
</tr>
</tbody></table>
<h2 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h2><h3 id="同步读取方法（readFileSync）"><a href="#同步读取方法（readFileSync）" class="headerlink" title="同步读取方法（readFileSync）"></a>同步读取方法（readFileSync）</h3><p><code>readFileSync</code> 有两个参数：</p>
<ul>
<li>第一个参数为读取文件的路径</li>
<li>第二个参数为 <code>options</code>，默认值为 <code>null</code>，其中有 <code>encoding</code>（编码，默认为 <code>null</code>）和 <code>flag</code>（标识位，默认为 <code>r</code>），也可直接传入 <code>encoding</code>；</li>
<li>返回值为文件的内容，如果没有 <code>encoding</code>，返回的文件内容为 <code>Buffer</code>，如果有按照传入的编码解析。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = requere(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> data = fs.readFileSyc(<span class="string">'a.txt'</span>, <span class="string">'utf8'</span>); </span><br><span class="line"><span class="comment">// let data = fs.readFileSync('index.js', &#123;encoding: 'utf8', flag: 'r+'&#125;)</span></span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br></pre></td></tr></table></figure>

<h3 id="异步读取文件（readFile）"><a href="#异步读取文件（readFile）" class="headerlink" title="异步读取文件（readFile）"></a>异步读取文件（readFile）</h3><p>异步读取方法 <code>readFile</code> 与 <code>readFileSync</code> 的前两个参数相同，最后一个参数为回调函数，函数内有两个参数 <code>err</code>（错误）和 <code>data</code>（数据）</p>
<ul>
<li>当正常读取时，<code>err</code>参数为<code>null</code>，<code>data</code>参数为读取到的<code>String</code>。</li>
<li>当读取发生错误时，<code>err</code>参数代表一个错误对象，<code>data</code>为<code>undefined</code>。</li>
</ul>
<p>这也是Node.js标准的回调函数：<strong>第一个参数代表错误信息，第二个参数代表结果</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'a.txt'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<h2 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h2><h3 id="同步写入（writeFileSync）"><a href="#同步写入（writeFileSync）" class="headerlink" title="同步写入（writeFileSync）"></a>同步写入（writeFileSync）</h3><p><code>writeFileSync</code> 有三个参数：</p>
<ul>
<li>第一个参数为写入文件的路径或文件描述符；</li>
<li>第二个参数为写入的数据，类型为 <code>String</code> 或 <code>Buffer</code>；</li>
<li>第三个参数为 <code>options</code>，默认值为 <code>null</code>，其中有 <code>encoding</code>（编码，默认为 <code>utf8</code>）、 <code>flag</code>（标识位，默认为 <code>w</code>）和 <code>mode</code>（权限位，默认为 <code>0o666</code>），也可直接传入 <code>encoding</code>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.writeFileSync(<span class="string">'a.txt'</span>,<span class="string">'hello world'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="异步写入（writeFile）"><a href="#异步写入（writeFile）" class="headerlink" title="异步写入（writeFile）"></a>异步写入（writeFile）</h3><p>异步写入方法 <code>writeFile</code> 与 <code>writeFileSync</code> 的前三个参数相同，最后一个参数为回调函数，函数内有一个参数 <code>err</code>（错误），回调函数在文件写入数据成功后执行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fs.writeFile(<span class="string">"2.txt"</span>, <span class="string">"Hello world"</span>, err =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">        fs.readFile(<span class="string">"2.txt"</span>, <span class="string">"utf8"</span>, (err, data) =&gt; &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data); <span class="comment">// Hello world</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p>感谢我的小兔兔@<a href="https://gryffinbit.top/" target="_blank" rel="noopener">兔子</a>一直陪在我身边，要一直一直爱你！</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Dar1in9</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://dar1in9s.github.io/2020/05/19/nodejs%E7%9A%84%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/">http://dar1in9s.github.io/2020/05/19/nodejs%E7%9A%84%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://Dar1in9s.github.io">Dar1in9's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/node-js/">node.js</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/05/19/express%E6%A1%86%E6%9E%B6/"><i class="fa fa-chevron-left">  </i><span>express框架</span></a></div><div class="next-post pull-right"><a href="/2020/05/08/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E4%BB%A5%E5%8F%8A%E5%B8%B8%E8%A7%81%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F/"><span>命令注入以及常见绕过方式</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://blog-1300147235.cos.ap-chengdu.myqcloud.com/Background2.png)"><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2021 By Dar1in9</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script src="/js/search/algolia.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>